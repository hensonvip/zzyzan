!function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="/assets/",t(0)}([function(e,t,i){i(7)()},function(e,t){e.exports=function(e){"loading"!=document.readyState?e():document.addEventListener?document.addEventListener("DOMContentLoaded",e):document.attachEvent("onreadystatechange",function(){"loading"!=document.readyState&&e()})}},function(e,t){e.exports=function(){var e,t=Array.prototype.slice.call(arguments),i=t.length,n={},a="",r=0,s=0,o=0,l=0,c=Object.prototype.toString,u=!0;for(o=0;i>o;o++)if("[object Array]"!==c.call(t[o])){u=!1;break}if(u){for(u=[],o=0;i>o;o++)u=u.concat(t[o]);return u}for(o=0,l=0;i>o;o++)if(e=t[o],"[object Array]"===c.call(e))for(s=0,r=e.length;r>s;s++)n[l++]=e[s];else for(a in e)e.hasOwnProperty(a)&&(parseInt(a,10)+""===a?n[l++]=e[a]:n[a]=e[a]);return n}},function(module,exports){module.exports=function(){var defaults=["type","size","content","wrapper"],types=["loading","success","error","question","info","ban","warning"],sizes=["small","middle","large"],wrappers=["div","span"],type,icon,size,wrapper,content,args=arguments;switch(args.length){case 0:return!1;case 1:content=args[0];break;case 2:type=args[0],content=args[1];break;default:for(var i in args)eval(defaults[i]+" = args[i];")}switch(type||(type=types[0]),size||(size=sizes[0]),wrapper||(wrapper=wrappers[0]),type){case"success":icon="check-circle";break;case"error":icon="times-circle";break;case"info":case"warning":icon="exclamation-circle";break;case"question":case"help":icon="question-circle";break;case"ban":icon="minus-circle";break;case"loading":case"spinner":icon="circle-o-notch fa-spin";break;default:icon=type}return"<"+wrapper+' class="tip-status tip-status-'+size+" tip-status-"+type+'"><i class="fa fa-'+icon+' fa-fw"></i> '+content+"</"+wrapper+">"}},,,,function(e,t,i){var n=i(1),a=i(2),r=i(3),s=i(13);e.exports=function(){function e(){T.$loading_tip=I(S.loading_tip_id),T.$add=I(S.add_id),T.$file=I(S.file_id),T.$reload=I(S.reload_id),T.$completion_tip=I(S.completion_tip_id),T.$tools=I(S.tools_id),T.$tpl=I(S.tpl_id),T.$unauthorize=I(S.unauthorize_id),T.$error_file_tip=I(S.error_file_tip_id),T.$error_files=I(S.error_files),T.$progress=I(S.progress_id),T.$progress_tx=I(S.progress_tx_id),T.$progress_bar=I(S.progress_bar_id),T.$thumbnail_remove=I(S.thumbnail_remove_id),T.$thumbnail_tip=I(S.thumbnail_tip_id),T.$thumbnail_preview=I(S.thumbnail_preview_id),T.$thumbnail_url=I(S.thumbnail_url_id),T.$split=I("sinapicv2-split"),T.$post_content=I("content"),T.$loading_tip.style.display="none",T.$add.style.display="block",E(),$(),w(),z(),T.$reload&&T.$reload.addEventListener("click",function(e){e.preventDefault(),t()}),T.$file.addEventListener("change",i),T.$file.addEventListener("drop",o)}function t(){T.$loading_tip.style.display="block",T.$unauthorize.style.display="none";var e=new XMLHttpRequest;e.open("get",S.process_url+"&type=check_authorize"),e.send(),e.onload=function(){if(e.status>=200&&e.status<400){var t;try{t=JSON.parse(e.responseText)}catch(i){t=e.responseText}t&&"success"===t.status?T.$add.style.display="block":t&&"error"===t.status?(alert(t.msg),T.$unauthorize.style.display="block"):(alert(S.lang.E03),T.$unauthorize.style.display="block")}else T.$unauthorize.style.display="block",T.$loading_tip.style.display="none";T.$loading_tip.style.display="none"},e.onerror=function(){T.$unauthorize.style.display="block",T.$loading_tip.style.display="none"}}function i(e){e.stopPropagation(),e.preventDefault(),T.files=e.target.files.length?e.target.files:e.originalEvent.dataTransfer.files,l()}function o(e){e.stopPropagation(),e.preventDefault(),T.files=e.dataTransfer.files,l()}function l(){T.file_count=T.files.length,T.file=T.files[0],T.file_index=0,T.$error_file_tip.style.display="none",T.$error_file_tip.innerHTML="",T.$completion_tip.style.display="none",c(T.files[0])}function c(e){T.start_time=new Date,p(e)}function u(e){if("hide"===e)return T.$error_files.innerHTML="",void(T.$error_file_tip.style.display="none");var t=document.createElement("div");t.innerHTML+='<span class="error-file">'+e.name+"</span>",T.$error_file_tip.appendChild(t.querySelector("span")),T.$error_file_tip.style.display="block"}function p(e){T.is_uploading=!0,_();var t=new FormData,i=new XMLHttpRequest;t.append("file",e),i.open("post",S.process_url+"&type=upload"),i.send(t),i.onload=function(){if(i.status>=200&&i.status<304){var e;try{e=JSON.parse(this.responseText)}catch(t){e=this.responseText}f(e)}else m(),T.is_uploading=!1},i.onerror=function(){m(),T.is_uploading=!1},i.upload.onprogress=function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;T.$progress_bar.style.width=t+"%"}}}function d(e,t){e&&"loading"!==e?(T.$completion_tip.innerHTML=r(e,t),T.$completion_tip.style.display="block",T.$progress.style.display="none",T.$add.style.display="block"):(T.$progress_tx.innerHTML=r("loading",t),T.$progress.style.display="block",T.$add.style.display="none",T.$completion_tip.style.display="none")}function _(){var e=s(S.lang.M01,T.file_index+1,T.file_count);T.$progress_bar.style.width="1%",d("loading",e)}function f(e){if(T.file_index++,e&&"success"===e.status){url=e.img_url;var t={img_url:url,size:""},i=document.createElement("div");i.innerHTML=M(t);var n=i.querySelector("table");T.$tpl.style.display="block",T.$tpl.insertBefore(n,T.$tpl.firstChild),n.style.display="table",y(url);var a=I("img-alt-"+b(url));if(T.$post_title||(T.$post_title=I("title")),a.value=T.$post_title.value,a.select(),k(url),T.$tools.style.display&&"none"!==T.$tools.style.display||(T.$tools.style.display="block"),T.file_count===T.file_index){T.all_complete=!0,T.is_uploading=!1;var r=s(S.lang.M02,T.file_count);d("success",r),T.$file.value=""}else v(T.files[T.file_index])}else T.file_index>0&&u(T.files[T.file_index-1]),T.file_count>T.file_index?v(T.files[T.file_index]):(T.is_uploading=!1,e&&"error"===e.status?m(e.msg):(m(S.lang.E02),console.error(e)),T.$file.value="")}function v(e){var t=new Date,i=t-T.start_time,n=S.interval-i,n=0>n?0:n;setTimeout(function(){c(e)},n)}function m(e){e=e?e:S.lang.E02,d("error",e)}function g(e,t){e||(e="square");var i=t.split("/"),n=i.length,a=i[n-1],r=i[n-2],s=t.substr(0,t.indexOf(r));return url=s+e+"/"+a,url}function b(e){var t=e.split("/"),t=t[t.length-1].split(".")[0];return t}function y(e){var t=b(e);for(var i in S.sizes)I(""+i+"-"+t).addEventListener("click",function(){var i=this,n=g(i.value,e);I("img-url-"+t).value=n,I("img-link-"+t).setAttribute("href",n),localStorage.setItem(S.storage_last_size_key,i.value)})}function h(e){var t=tinymce.editors.content;t&&!t.isHidden()?t.execCommand("mceInsertContent",!1,e):"undefined"!=typeof QTags?QTags.insertContent(e):T.$post_content.value+=e}function $(){S.authorized===!1?(T.$unauthorize.style.display="block",T.$add.style.display="none"):T.$add.style.display="block"}function w(){function e(e){e.preventDefault();var i=this,n=T.$tpl.querySelectorAll("input.img-url"),a=0;if(!n[0])return!1;for(var r=[],s=0,o=n.length;o>s;s++){var l=n[s],c=l.value;"sinapicv2-insert-list-with-link"===i.id?r.push(t(c,!0)):r.push(t(c,!1)),T.$split.value>0&&o-1>a&&(a+1)%T.$split.value==0&&r.push(" <!--nextpage--> "),a++}r&&h(r.join(""))}var t=function(e,t){if("undefined"==typeof e)return!1;var i,n=g("large",e),a=b(e),r=I("img-url-"+a).value,s=I("img-alt-"+a).value,o=' alt="'+s+'"',l=S.show_title?' title="'+s+'" ':"",c='<img src="'+r+'" '+o+l+"/>";return i=t===!0?'<a href="'+n+'" target="_blank">'+c+"</a>":c,i="<p>"+i+"</p>"};I("sinapicv2-insert-list-with-link").addEventListener("click",e),I("sinapicv2-insert-list-without-link").addEventListener("click",e)}function k(e){function t(){var e=I("img-alt-"+i).value,t=' alt="'+e+'"',n=S.show_title?' title="'+e+'" ':"";return'<img src="'+a.value+'" '+t+n+"/>"}var i=b(e),n="",a=I("img-url-"+i);a.addEventListener("click",function(){this.select()}),large_size_url=g("large",e),I("btn-with-link-"+i).addEventListener("click",function(e){e.preventDefault(),n='<a href="'+large_size_url+'" target="_blank">'+t()+"</a>",h(n)}),I("btn-without-link-"+i).addEventListener("click",function(e){e.preventDefault(),n=t(),h(n)}),I("btn-as-feature-image"+i).addEventListener("click",function(){var t=this;if(t.classList.contains("button-primary"))t.classList.remove("button-primary"),L();else{for(var i=document.querySelectorAll(".btn-as-feature-image"),n=0,a=i.length;a>n;n++)i[n].classList.remove("button-primary");t.classList.add("button-primary"),x(e)}})}function x(e){e=g(S.thumbnail_size,e),T.$thumbnail_tip.style.display="none",T.$thumbnail_url.value=e,T.$thumbnail_preview.style.display="block",T.$thumbnail_preview.innerHTML='<img src="'+e+'" alt="">',T.$thumbnail_remove.style.display="block"}function L(){T.$thumbnail_remove.style.display="none",T.$thumbnail_tip.style.display="block",T.$thumbnail_url.value="",T.$thumbnail_preview.style.display="none";var e=T.$thumbnail_preview.querySelector("img");e.parentNode.removeChild(e)}function E(){T.$thumbnail_remove.addEventListener("click",function(){for(var e=document.querySelectorAll(".btn-as-feature-image"),t=0,i=e.length;i>t;t++)e[t].classList.remove("button-primary");L()})}function M(e){if(!e)return!1;var t=b(e.img_url),i=e.img_url,n="",a="",r=localStorage.getItem(S.storage_last_size_key);r||(r=S.default_size);for(var s in S.sizes)a=r===s?' checked="checked" ':"",n+='<label for="'+s+"-"+t+'" title="'+S.sizes[s]+'" class="sizes-label"><input id="'+s+"-"+t+'" name="sinapic[size-'+t+']" class="size-input" type="radio" value="'+s+'"'+a+"/><span>"+s+"</span></label>";var o='<table class="tpl-table" id="table-'+t+'"><tbody><tr><th><a id="img-link-'+t+'" href="'+g(r,i)+'" target="_blank" class="img-preview-link"><img id="img-preview-'+t+'" class="img-preview" src="'+g("square",i)+'" alt="preview"/></a></th><td><div class="size-group">'+n+'</div><input id="img-url-'+t+'" type="text" class="img-url widefat" value="'+g(r,i)+'" name="sinapic[img-url-'+t+']" readonly="true"/></td></tr><tr><th><label for="img-alt-'+t+'">'+S.lang.M04+'</label></th><td><input id="img-alt-'+t+'" type="text" class="img-alt widefat" placeholder="'+S.lang.M05+'"/></td></tr><tr><th>'+S.lang.M06+'</th><td scope="col" colspan="2"><a id="btn-with-link-'+t+'" href="javascript:;" class="button button-primary">'+S.lang.M07+'</a> <a id="btn-without-link-'+t+'" href="javascript:;" class="button">'+S.lang.M08+'</a> <a href="javascript:;" id="btn-as-feature-image'+t+'" class="button btn-as-feature-image">'+S.lang.M09+"</a></td></tr></tbody></table>";return o}function z(){return T.$clear_list=I("sinapicv2-clear-list"),T.$clear_list?void T.$clear_list.addEventListener("click",function(){T.$tools.style.display="none",T.$completion_tip.style.display="none",T.$error_file_tip.style.display="none",T.$error_file_tip.innerHTML="",T.$tpl.innerHTML=""}):!1}var T={file_index:0,file_count:0,files:!1,error_files:[],is_uploading:!1},S={process_url:"",file_id:"sinapicv2-file",add_id:"sinapicv2-add",loading_tip_id:"sinapicv2-loading-tip",completion_tip_id:"sinapicv2-completion-tip",btns_id:"sinapicv2-btns",tpl_id:"sinapicv2-tpl-container",tools_id:"sinapicv2-tools",unauthorize_id:"sinapicv2-unauthorize",go_authorize_id:"sinapicv2-go-authorize",reload_id:"sinapicv2-reloadme",error_file_tip_id:"sinapicv2-error-file-tip",error_files:"sinapicv2-error-files",progress_id:"sinapicv2-progress",progress_tx_id:"sinapicv2-progress-tx",progress_bar_id:"sinapicv2-progress-bar",thumbnail_remove_id:"sinapicv2-thumbnail-remove",thumbnail_url_id:"sinapicv2-thumbnail-url",thumbnail_preview_id:"sinapicv2-thumbnail-preview",thumbnail_tip_id:"sinapicv2-thumbnail-tip",accept_formats:["png","jpg","gif"],storage_last_size_key:"sinapic_last_size",authorized:!1,is_ssl:!1,max_upload_size:2097152,interval_timer:3e3,show_title:!1,thumbnail_size:"thumb150",lang:{E01:"Error: ",E02:"Upload failed, please login weibo and try again. If you still failed, please contact the plugin author.",E03:"Sorry, plugin can not get authorized data, please try again later or contact plugin author.",M01:"Uploading {0}/{1}, please wait...",M02:"{0} files have been uploaded, enjoy it.",M03:"Image URL: ",M04:"ALT attribute: ",M05:"Set ALT attribute text",M06:"Control: ",M07:"Insert to post with link",M08:"Insert to post image only",M09:"As custom meta feature image",M10:"Detects that files can not be uploaded:"},sizes:{thumb150:"max 150x150, crop",thumb300:"max 300x300, crop",mw600:"max-width:600",large:"original size",square:"max-width:80 or max-height:80",thumbnail:"max-width:120 or max-height:120",bmiddle:"max-width:440"},default_size:"bmiddle"},I=function(e){return document.getElementById(e)};S=a(S,window.PLUGIN_CONFIG_sinapicv2),n(e)}},,,,,,function(e,t){e.exports=function(){var e=arguments;return arguments[0].replace(/\{(\d+)\}/g,function(t,i){return e[parseInt(i)+1]})}}]);